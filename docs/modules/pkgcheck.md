# 🛡️ 智能包检查器 (`pkgcheck`)

`pkgcheck` 是 otex 的技术核心，它是一套基于 LaTeX3 的防御性宏包管理逻辑。

---

## 1. 核心 API：`\otex_require:nnnn`

otex 的所有子模块都不会直接调用标准的 `\RequirePackage`，而是使用这个智能接口：

```latex
\otex_require:nnnn {包名} {默认选项} {冲突选项} {必需选项}
```

### 工作逻辑

1. **未加载时**：以“默认选项”加载宏包。
2. **已加载时**：
   - 检查用户是否误传了“冲突选项”，若是，则抛出警告。
   - 检查用户是否漏传了“必需选项”，若是，则抛出警告。
3. **后置处理**：保证不管包是怎么进来的，后续的配置代码都能正确执行。

## 2. 提供的辅助命令

- `\otex_merge_setup:nn`: 智能合并包配置。
- `\otex_provide_command:Nnn`: 防御性命令定义，只有在该命令不存在时才定义，防止 `Command already defined`。
- `\otex_provide_env:nnnn`: 同理，防御性定义环境。

## 3. 它的意义

这个模块的存在，确保了 otex 能够被顺利集成到各种高度定制化的 LaTeX 模板（如中科大、哈工大的学位论文模板）中，而不会因为重复加载包或选项冲突导致编译崩溃。

---
[返回模块总览](README.md)
