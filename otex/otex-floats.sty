\ProvidesExplPackage {otex/otex-floats} {2025-01-16} {1.1} {Orion's Floats}

% ==============================================================================
% 浮动体控制宏包 (Floats Control)
% ==============================================================================

% 1. 强力浮动体控制 (float)
\otex_smart_require:nnnn { float } {} {} {}

% 2. placeins (限制浮动体在章节内)
\bool_if:NT \g_otex_float_section_bool
  {
    \otex_smart_require:nnnn { placeins }
      { section }            % Default: add section barriers
      { required={section} } % Validation: Warn if loaded without section support? 
                             % Actually section option just redefines \section. 
                             % If user didn't load it, we can manual patch too.
      { }
  }

% 3. flafter (确保浮动体在引用之后)
\otex_smart_require:nnnn { flafter } {} {} {}

% ------------------------------------------------------------------------------
% 放宽浮动体默认参数
% ------------------------------------------------------------------------------
\cs_set:Npn \topfraction { 0.85 }
\cs_set:Npn \bottomfraction { 0.70 }
\cs_set:Npn \textfraction { 0.10 }
\cs_set:Npn \floatpagefraction { 0.60 }
\cs_set:Npn \dblfloatpagefraction { 0.60 }

\setcounter { topnumber } { 4 }
\setcounter { bottomnumber } { 3 }
\setcounter { totalnumber } { 8 }
\setcounter { dbltopnumber } { 4 }

\skip_set:Nn \textfloatsep { 12pt plus 4pt minus 3pt }
\skip_set:Nn \floatsep { 10pt plus 3pt minus 2pt }
\skip_set:Nn \intextsep { 12pt plus 4pt minus 3pt }
\skip_set:Nn \dbltextfloatsep { 12pt plus 4pt minus 3pt }
\skip_set:Nn \dblfloatsep { 10pt plus 3pt minus 2pt }

\endinput
