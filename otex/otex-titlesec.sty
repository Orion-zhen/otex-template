\ProvidesExplPackage {otex/otex-titlesec} {2026-01-18} {1.1} {Orion's Titlesec Configuration}

\bool_if:NF \g_otex_load_titlesec_bool { \endinput }

% 环境支撑探测：验证当前排版引擎是否具备标准章节管理接口，防止在非标准排版系统下发生致命错误
\cs_if_exist:NF \l@section
{
  \msg_warning:nnnn { otex } { pkg-skip } { titlesec } { \\l@section~undefined~(non-standard~document~class) }
  \endinput
}

% 标题样式系统 (titlesec)：通过特征命令 \titleformat 探测全局加载状态，并安全注入学术化预设
% 守护符号探测：\titleformat
\otex_safe_require:nnnn { titlesec } {} { \titleformat }
{
  % 样式定制驱动：在宏包成功激活后，依据语言环境分发标题排版逻辑
  \bool_if:NF \l_otex_pkg_preloaded_bool
  {
    % 视觉美学设计：提供受主流学术期刊启发的整洁、专业的排版风格
    \bool_if:NTF \g_otex_english_bool
    {
      % 国际化适配：英语学术标题预设 (符合 IEEE/ACM 等通用惯例)
      \titleformat{\section}
      {\normalfont\Large\bfseries}
      {\thesection.}{0.5em}{}

      \titleformat{\subsection}
      {\normalfont\large\bfseries}
      {\thesubsection}{0.5em}{}

      \titleformat{\subsubsection}
      {\normalfont\normalsize\bfseries}
      {\thesubsubsection}{0.5em}{}

      \titleformat{\paragraph}[runin]
      {\normalfont\normalsize\bfseries}
      {}{0em}{}[.]
    }
    {
      % 国际化适配：中文学术标题预设 (增强的视觉留白与现代左对齐美感)
      \titleformat{\section}
      {\normalfont\Large\bfseries}
      {\chinese{section}、}{0em}{}

      \titleformat{\subsection}
      {\normalfont\large\bfseries}
      {\thesubsection}{0.5em}{}

      \titleformat{\subsubsection}
      {\normalfont\normalsize\bfseries}
      {\thesubsubsection}{0.5em}{}

      \titleformat{\paragraph}[runin]
      {\normalfont\normalsize\bfseries}
      {}{0em}{}[。]
    }

    % 几何布局精修：配置全局紧凑型学术间距策略
    \titlespacing*{\section}{0pt}{2.5ex plus 0.8ex minus 0.2ex}{1.5ex plus 0.2ex}
    \titlespacing*{\subsection}{0pt}{2ex plus 0.6ex minus 0.2ex}{1ex plus 0.2ex}
    \titlespacing*{\subsubsection}{0pt}{1.5ex plus 0.4ex minus 0.1ex}{0.8ex plus 0.1ex}
    \titlespacing*{\paragraph}{0pt}{1ex plus 0.2ex minus 0.1ex}{1em}
  }
}

\endinput
