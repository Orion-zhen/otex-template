\ProvidesExplPackage {otex/otex-toc} {2026-01-18} {1.3} {Orion's TOC}

\bool_if:NF \g_otex_load_toc_bool { \endinput }

% Symbol detection for standard sectioning commands
% tocloft requires \l@section etc. to exist (beamer and similar classes don't define these)
\cs_if_exist:NF \l@section
{
  \msg_warning:nnnn { otex } { pkg-skip } { tocloft } { \\l@section~undefined~(non-standard~document~class) }
  \endinput
}

% Symbol detection for tocloft (use representative command)
% Skip if tocloft or equivalent functionality already exists
% Also detect ccaption/subfig which defines \c@lofdepth and conflicts with tocloft
\bool_new:N \l_otex_toc_skip_bool
\cs_if_exist:NT \cftbeforetoctitleskip { \bool_set_true:N \l_otex_toc_skip_bool }
\cs_if_exist:NT \c@lofdepth { \bool_set_true:N \l_otex_toc_skip_bool }

\bool_if:NTF \l_otex_toc_skip_bool
{
  \msg_warning:nnnn { otex } { pkg-skip } { tocloft } { TOC~already~configured~or~lofdepth~conflict }
}
{
  % Logic Check: already done above (l_otex_toc_skip_bool checks cftbeforetoctitleskip etc)
  % Passing empty guard symbol because we handle detection manually.
  \otex_safe_require:nnnn { tocloft } {} {}
  {
    \setcounter{tocdepth}{3}
    \setcounter{secnumdepth}{3}
  }
}

\endinput
